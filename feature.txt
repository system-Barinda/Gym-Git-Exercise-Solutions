This is the core functionality for the new feature.
